<!DOCTYPE html>
<html>
<body>
<link rel="stylesheet" type="text/css" href="iso_style.css" />
<script type="text/javascript" src="d3.v3.min.js"></script>
<script type="text/javascript" src="jquery-1.8.2.js"></script>
<script type="text/javascript" src="draw_position.js"></script>
<script type="text/javascript" src="structures.js"></script>
<script type="text/javascript">
	var width = 500;
	var height = 500;
	
//	var edge = [{"from":"a","to":"b"}];
	
	$(document).ready(function(){
		height = $(window).height()-20;
		width = $(window).width()-20;
		//alert("in");
		var svg = d3.select("svg").attr("width", width).attr("height", height).append("g");
	
		for(i=0; i<10; i++){
			var v = new Vertex(i+"");
			for(j=1; j<10; j++){
				v.edges.push(new Edge(i+"", ((i+j) % 100)+"", 0));
			}
			graph.push(v);
		}
		
		var graphIn = svg.selectAll("circle").data(graph);

		//ENTER
		graphIn.enter().append("g").attr("id",function(d){return "v"+d.name});
		
		//UPDATE
		graphIn.each(function(d,i){
			////Make vertices
			var ind = i;
			d3.select(this).append("circle")
			.attr("cx", function(d){
			return completeGraphPosition( 2*Math.PI*(ind/graph.length) )[0];})
			.attr("cy", function(d){
			return completeGraphPosition( 2*Math.PI*(ind/graph.length) )[1];})
			.attr("r", 10);
			////Make labels for those vertices. Pretty lame right now.
			d3.select(this).append("text")
			.attr("x", function(d){
			return completeGraphPosition( 2*Math.PI*(ind/graph.length) )[0]-4;})
			.attr("y", function(d){
			return completeGraphPosition( 2*Math.PI*(ind/graph.length) )[1]+5;})
			.text(function(d){return d.name;});
		});



		//d3.select('#v2').attr("transform", "translate(-330,-10)");
		
		for(i=0; i<graph.length; i++){
			var vert = graph[i];
			console.log(vert);
			var edgeSet = svg.selectAll("line .e"+vert.name)
			.data(vert.edges);
			
			edgeSet.enter().append("line");
			edgeSet.each(calculateEdge);
		}

		//EXIT
		graphIn.exit().each(function(d){d3.selectAll("line .e"+d.name).remove()}).remove();//Remove all edges leading to/from vertex before removing vertex

	});

	
</script>
<svg></svg>
<textarea id="input"></textarea>
</body>
</html>